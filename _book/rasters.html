<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3 Rasters | GIS And Remote Sensing For Ecologists</title>
<meta name="author" content="Emilio Berti">
<meta name="generator" content="bookdown 0.38 with bs4_book()">
<meta property="og:title" content="3 Rasters | GIS And Remote Sensing For Ecologists">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="3 Rasters | GIS And Remote Sensing For Ecologists">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Source%20Code%20Pro&amp;display=swap" rel="stylesheet">
<script src="libs/bs3compat-0.6.2/transition.js"></script><script src="libs/bs3compat-0.6.2/tabs.js"></script><script src="libs/bs3compat-0.6.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<meta name="description" content="Because rasters are fundamentally 2D matrices with matadata, it is useful to understand what is a matrix before jumping straight into the topic. A 2D matrix \(A\) is a mathematical object that can...">
<meta property="og:description" content="Because rasters are fundamentally 2D matrices with matadata, it is useful to understand what is a matrix before jumping straight into the topic. A 2D matrix \(A\) is a mathematical object that can...">
<meta name="twitter:description" content="Because rasters are fundamentally 2D matrices with matadata, it is useful to understand what is a matrix before jumping straight into the topic. A 2D matrix \(A\) is a mathematical object that can...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">GIS And Remote Sensing For Ecologists</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="a-history-of-gis.html">A history of GIS</a></li>
<li><a class="" href="projections.html"><span class="header-section-number">1</span> Projections</a></li>
<li><a class="" href="shapefiles.html"><span class="header-section-number">2</span> Shapefiles</a></li>
<li><a class="active" href="rasters.html"><span class="header-section-number">3</span> Rasters</a></li>
<li><a class="" href="basic-operations.html"><span class="header-section-number">4</span> Basic Operations</a></li>
<li><a class="" href="vector-operations.html"><span class="header-section-number">5</span> Vector operations</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="rasters" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Rasters<a class="anchor" aria-label="anchor" href="#rasters"><i class="fas fa-link"></i></a>
</h1>
<p>Because rasters are fundamentally 2D matrices with matadata, it is useful to understand what is a matrix before jumping straight into the topic.
A 2D matrix <span class="math inline">\(A\)</span> is a mathematical object that can be represented as a grid.
The elements <span class="math inline">\(a_{ij}\)</span> of the matrix <span class="math inline">\(A\)</span> are called its entries.
The subscript in <span class="math inline">\(a_{ij}\)</span> indicate the row and column coordinates of the entries.
For example, <span class="math inline">\(a_{1,1}\)</span> is the element in first row and first column, while <span class="math inline">\(a_{3,4}\)</span> is the element in the third row and fourth column.</p>
<div id="matrices-in-r" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Matrices in R<a class="anchor" aria-label="anchor" href="#matrices-in-r"><i class="fas fa-link"></i></a>
</h2>
<p>R provides a native support for matrices.
In fact, R was designed to work with matrices, as statistical models (which are in the Râ€™s courtyard) can be represented as matrices.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">vals</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>When creating a matrix, there are two import things that are often neglected.
First, by specifying <code>byrow = TRUE</code>, we make sure that the values contained in <code>vals</code> are inserted into the matrix row-wise: <span class="math inline">\(a_{12}\)</span> is the second value of <code>vals</code>.
This argument can be omitted if inserting elements column-wise is preferred; in this case, <span class="math inline">\(a_{12}\)</span> will be the fourth element of <code>vals</code>.
As I find this a bit more confusing, I tend to prefer <code>byrow = TRUE</code> and work accordingly.
I do not want to recommend this choice, but keep in mind the <code>byrow</code> argument if your matrix looks weird.
Second, at least one of <code>ncol</code> or <code>nrow</code> should be specified, or the matrix will have only one column (column vectors).
If you specify only one of the two, R will infer the other dimension.
You can specify both of them and I invite you to do so for clarity, whenever possible.</p>
</div>
<div id="rasters-1" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Rasters<a class="anchor" aria-label="anchor" href="#rasters-1"><i class="fas fa-link"></i></a>
</h2>
<p>A raster is basically a 2D matrix with associated metadata.
The most important metadata define:</p>
<ul>
<li>The spatial <em>extent</em>.</li>
<li>The spatial <em>resolution</em>.</li>
<li>The coordinate reference system, <em>crs</em>.</li>
</ul>
<p>A raster without these three metadata is, in most cases, useless.</p>
</div>
<div id="rasters-in-r" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Rasters in R<a class="anchor" aria-label="anchor" href="#rasters-in-r"><i class="fas fa-link"></i></a>
</h2>
<p>In R, <em>terra</em> provides all you need to work with rasters.
To create a raster, you can use the <code>rast()</code> function.
You can use as input a matrix.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">rast</span><span class="op">(</span><span class="va">A</span>, crs <span class="op">=</span> <span class="st">"EPSG:4326"</span><span class="op">)</span></span>
<span><span class="va">r</span></span></code></pre></div>
<pre><code>## class       : SpatRaster 
## dimensions  : 3, 3, 1  (nrow, ncol, nlyr)
## resolution  : 1, 1  (x, y)
## extent      : 0, 3, 0, 3  (xmin, xmax, ymin, ymax)
## coord. ref. : lon/lat WGS 84 (EPSG:4326) 
## source(s)   : memory
## name        : lyr.1 
## min value   :     1 
## max value   :     9</code></pre>
<p>Or a dataframe.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>, <span class="co">#x coord</span></span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="co">#y coord</span></span>
<span>  z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> <span class="co">#values</span></span>
<span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">rast</span><span class="op">(</span><span class="va">d</span>, crs <span class="op">=</span> <span class="st">"EPSG:4326"</span><span class="op">)</span></span></code></pre></div>
<p><code>rast()</code> is also used to read rasters from files.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">rast</span><span class="op">(</span><span class="st">"some-file.tif"</span><span class="op">)</span></span></code></pre></div>
<p>To write rasters to files, the <code>writeRaster()</code> function is used.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">writeRaster</span><span class="op">(</span><span class="va">r</span>, <span class="st">"some-file.tif"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span>, datatype <span class="op">=</span> <span class="st">"INT4U"</span><span class="op">)</span></span></code></pre></div>
<p>The <code>overwrite</code> and <code>datatype</code> arguments are optional, but I strongly recommend you to always include them.
<code>overwrite = TRUE</code> simply make sure that, if the raster already exists on disk, it is overwritten; <em>terra</em>, by defaults, throw an error if the file exists and <code>overwrite = FALSE</code>, which is safer, but tends to be annoying on the long run.
<code>datatype</code> specifies the numeric type of the matrix elements.
Available types are <em>signed</em> and _u_nsigned _int_egers and _fl_oa_t_ing point numbers.
You also have to specify the number of bytes to use for each entry.
Available dataype choices are:</p>
<ul>
<li>INT1U, unsigned integer of 1 byte: <span class="math inline">\(\in [0, 2^8]\)</span>.</li>
<li>INT2U, unsigned integer of 2 bytes: <span class="math inline">\(\in [0, 2^{16}]\)</span>.</li>
<li>INT2S, signed integer of 2 bytes: <span class="math inline">\(\in [-2^8 + 1, 2^8]\)</span>.</li>
<li>INT4U, unsigned integer of 4 bytes: <span class="math inline">\(\in [0, 2^{32}]\)</span>.</li>
<li>INT4S, signed integer of 4 bytes: <span class="math inline">\(\in [-2^{16} + 1, 2^{16}]\)</span>.</li>
<li>FLT4S, signed floating point (real) number of 4 bytes: <span class="math inline">\(\in [1.2 \cdot 10^{-38}, 3.4 \cdot 10^{38}]\)</span>
</li>
<li>FLT8S, signed floating point (real) number of 8 bytes: <span class="math inline">\(\in [2.3 \cdot 10^{-308}, 1.7 \cdot 10^{308}]\)</span>
</li>
</ul>
<p>You can actually store numbers also outside the range of the numeric types, but this will come to the cost of precision, so you should try to avoid going outside ranges.
This does not mean that you should always save files as <em>FLT8S</em>, as this will require more disk space and slow down writing/reading operations.
For example, if you want to store the elevation at global scale with a precision of one meter, <em>INT2U</em> is the optimal choice, as it is the smallest type that can store the information.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="shapefiles.html"><span class="header-section-number">2</span> Shapefiles</a></div>
<div class="next"><a href="basic-operations.html"><span class="header-section-number">4</span> Basic Operations</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#rasters"><span class="header-section-number">3</span> Rasters</a></li>
<li><a class="nav-link" href="#matrices-in-r"><span class="header-section-number">3.1</span> Matrices in R</a></li>
<li><a class="nav-link" href="#rasters-1"><span class="header-section-number">3.2</span> Rasters</a></li>
<li><a class="nav-link" href="#rasters-in-r"><span class="header-section-number">3.3</span> Rasters in R</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>GIS And Remote Sensing For Ecologists</strong>" was written by Emilio Berti. It was last built on 2024-03-27.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
